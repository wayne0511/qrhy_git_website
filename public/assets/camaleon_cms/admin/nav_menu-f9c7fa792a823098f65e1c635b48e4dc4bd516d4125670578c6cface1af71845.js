(function(){$(function(){var n,e,r,t,a,o;return a=$("#menu_content"),r=$("#menu_form"),e=$("#menus_list"),t=$("#menu_items"),e.nestable(),n={items:e.nestable("serialize")},e.on("change",function(){var i;if(i={items:e.nestable("serialize")},JSON.stringify(n)!==JSON.stringify(i))return a.find("#menu_reoreder_loading").show(),$.post(e.attr("data-reorder_url"),i,function(t){if(n=i,a.find("#menu_reoreder_loading").hide(),t)return alert(t)})}),o=function(t){return showLoading(),$.post(e.attr("data-url"),t,function(t){return e.children(".dd-list").append($(t).children()),hideLoading()})},t.find(".add_links_to_menu").click(function(){var t,i;return t={items:[],authenticity_token:r.find('[name="authenticity_token"]').val()},i=!1,$(this).closest(".panel").find("input:checkbox:checked").each(function(){return i=!0,t.items.push({id:$(this).val(),kind:$(this).closest(".class_type").attr("data-type")})}).prop("checked",!1),i&&o(t),!1}),t.find(".add_links_custom_to_menu").click(function(){var t,i;return t={custom_items:[],authenticity_token:r.find('[name="authenticity_token"]').val()},i=!1,$(this).closest(".panel").find("input:checkbox:checked").each(function(){return i=!0,t.custom_items.push({url:$(this).val(),kind:$(this).attr("data-kind"),label:$(this).attr("data-label")})}).prop("checked",!1),i&&o(t),!1}),t.find(".form-custom-link").submit(function(){var t;return(t=$(this)).valid()&&(o({external:t.serializeObject()}),this.reset(),setTimeout(function(){return t.find("label.error").hide()},100)),!1}),e.on("click",".item_external",function(){var n;return n=$(this),open_modal({title:n.attr("data-original-title")||n.attr("title"),url:n.attr("href"),mode:"ajax",callback:function(i){var t;return t=i.find("form"),init_form_validations(t),t.submit(function(){return t.valid()&&(showLoading(),$.post(t.attr("action"),t.serialize(),function(t){return n.closest("li").replaceWith($(t).html()),i.modal("hide"),hideLoading()})),!1})}}),!1}),e.on("click",".delete_menu_item",function(){var t;return t=$(this),confirm(I18n("msg.confirm_del","Are you sure to delete this item?"))&&(showLoading(),$.get(t.attr("href"),function(){return t.closest(".dd-item").remove(),hideLoading()})),!1}),a.find(".new_menu_link, .edit_menu_link").ajax_modal({callback:function(t){var i;return i=t.find("form"),setTimeout(function(){return init_form_validations(i)},1e3)}}),a.find("#menu_items #switch_nav_menu_form select").change(function(){if($(this).val())return $(this).closest("form").submit()}),e.on("click",".custom_settings_link",function(){var t;return t=$(this),open_modal({title:t.attr("data-original-title")||t.attr("title"),url:t.attr("href"),mode:"ajax",callback:function(i){var t;return t=i.find("form"),init_form_validations(t),t.submit(function(){return t.valid()&&(showLoading(),$.post(t.attr("action"),t.serialize(),function(t){return t&&alert(t),i.modal("hide"),hideLoading()})),!1})}}),!1})})}).call(this);